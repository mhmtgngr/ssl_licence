{% extends "base.html" %}
{% block title %}{{ product.name }}{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h4><i class="bi bi-box-seam"></i> {{ product.name }}</h4>
    <a href="{{ url_for('products.list_products') }}" class="btn btn-outline-secondary"><i class="bi bi-arrow-left"></i> Back</a>
</div>

<div class="row g-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">Product Info</div>
            <div class="card-body">
                <table class="table table-sm mb-0">
                    <tr><th>ID</th><td><code>{{ product.product_id }}</code></td></tr>
                    <tr><th>Vendor</th><td>{{ product.vendor }}</td></tr>
                    <tr><th>Version</th><td>{{ product.version }}</td></tr>
                    <tr><th>Category</th><td>{{ product.category.value|replace('_', ' ')|title }}</td></tr>
                    <tr><th>Status</th><td><span class="badge badge-{{ product.support_status().value }}">{{ product.support_status().value|replace('_', ' ')|title }}</span></td></tr>
                    <tr><th>Environment</th><td>{{ product.environment }}</td></tr>
                    <tr><th>Owner</th><td>{{ product.owner or '-' }}</td></tr>
                    <tr><th>Department</th><td>{{ product.department or '-' }}</td></tr>
                    <tr><th>Tags</th><td>{% for t in product.tags %}<span class="badge bg-secondary me-1">{{ t }}</span>{% endfor %}{% if not product.tags %}-{% endif %}</td></tr>
                    <tr><th>Active</th><td>{{ 'Yes' if product.is_active else 'No' }}</td></tr>
                </table>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">Licence & Support</div>
            <div class="card-body">
                <table class="table table-sm mb-0">
                    <tr><th>Licence Type</th><td>{{ product.licence_type.value|replace('_', ' ')|title }}</td></tr>
                    <tr><th>Licence Key</th><td><code>{{ product.licence_key or '-' }}</code></td></tr>
                    <tr><th>Quantity</th><td>{{ product.licence_quantity }}</td></tr>
                    <tr><th>Annual Cost</th><td>{% if product.annual_cost %}${{ "{:,.2f}".format(product.annual_cost) }}{% else %}-{% endif %}</td></tr>
                    <tr><th>Licence Expiry</th><td>{{ product.licence_expiry.strftime('%Y-%m-%d') if product.licence_expiry else '-' }}</td></tr>
                    <tr><th>Days to Expiry</th><td>
                        {% set days = product.days_until_licence_expiry() %}
                        {% if days is not none %}
                            {% if days < 0 %}<span class="text-danger">Expired ({{ days|abs }}d ago)</span>
                            {% elif days <= 30 %}<span class="text-warning">{{ days }} days</span>
                            {% else %}{{ days }} days{% endif %}
                        {% else %}-{% endif %}
                    </td></tr>
                    <tr><th>Mainstream Support</th><td>{{ product.mainstream_support_end.strftime('%Y-%m-%d') if product.mainstream_support_end else '-' }}</td></tr>
                    <tr><th>Extended Support</th><td>{{ product.extended_support_end.strftime('%Y-%m-%d') if product.extended_support_end else '-' }}</td></tr>
                    <tr><th>End of Life</th><td>{{ product.end_of_life.strftime('%Y-%m-%d') if product.end_of_life else '-' }}</td></tr>
                </table>
            </div>
        </div>
    </div>
</div>

{% if product.notes %}
<div class="card mt-4">
    <div class="card-header">Notes</div>
    <div class="card-body">{{ product.notes }}</div>
</div>
{% endif %}
{% endblock %}
