{% extends "base.html" %}
{% block title %}Alerts{% endblock %}
{% block content %}
<h4 class="mb-4"><i class="bi bi-bell"></i> Alerts <span class="badge bg-secondary">{{ alerts|length }}</span></h4>

<form method="get" class="filter-bar row g-2 mb-4">
    <div class="col-md-3">
        <select name="level" class="form-select form-select-sm">
            <option value="">All Levels</option>
            {% for lvl in AlertLevel %}
            <option value="{{ lvl.value }}" {% if filters.level == lvl.value %}selected{% endif %}>{{ lvl.value|upper }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-3">
        <select name="type" class="form-select form-select-sm">
            <option value="">All Types</option>
            {% for t in AlertType %}
            <option value="{{ t.value }}" {% if filters.type == t.value %}selected{% endif %}>{{ t.value|replace('_', ' ')|title }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-3">
        <input type="text" name="vendor" class="form-control form-control-sm" placeholder="Vendor" value="{{ filters.vendor or '' }}">
    </div>
    <div class="col-md-3">
        <button type="submit" class="btn btn-outline-secondary btn-sm w-100"><i class="bi bi-funnel"></i> Filter</button>
    </div>
</form>

<div class="card">
    <div class="card-body">
        {% if alerts %}
        <div class="table-responsive">
            <table class="table table-sm table-hover mb-0">
                <thead>
                    <tr>
                        <th>Level</th>
                        <th>Product</th>
                        <th>Vendor</th>
                        <th>Type</th>
                        <th>Days Remaining</th>
                        <th>Target Date</th>
                        <th>Message</th>
                    </tr>
                </thead>
                <tbody>
                    {% for alert in alerts %}
                    <tr>
                        <td><span class="badge badge-{{ alert.alert_level.value }}">{{ alert.alert_level.value|upper }}</span></td>
                        <td>{{ alert.product_name }}</td>
                        <td>{{ alert.vendor }}</td>
                        <td>{{ alert.alert_type.value|replace('_', ' ')|title }}</td>
                        <td>{{ alert.days_remaining }}</td>
                        <td>{{ alert.target_date.strftime('%Y-%m-%d') }}</td>
                        <td><small>{{ alert.message }}</small></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <i class="bi bi-shield-check"></i>
            <p>No alerts match your filters.</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
